var Jef=function(){"use strict";var t=function(t,e){e||(e=".");for(var r="",n=0;n<t.length;n++)0!==n&&(r+=e),r+=t[n];return r},e=function(e,r){this.isRoot=!1,this.root=r,r.path===e.path&&(this.isRoot=!0),this.level=e.pathArray.length-r.pathArray.length,this.pathArray=e.pathArray.slice(r.pathArray.length,e.pathArray.length),this.path=t(this.pathArray)},r=function(h){this.isEmpty=function(){return 0===this.count},this.get=function(t){if(!t)return this;var e;return e=this.isRoot?t:this.path+"."+t,this._nodeHash[a+"."+e]},this._iterate=function(e){var r=this;i(this.value,function(n,i,a,h,s,o,u){var f=r._internalPath+(u?"":"."+t(a)),l=r._nodeHash[f];e(l)})},this.filter=function(t){var r=[],n=this;return this._iterate(function(i){var a=t(i,new e(i,n));void 0!==a&&r.push(a)}),r},this.validate=function(t){var e=!0;return this.filter(function(r,n){var i=t(r,n);i===!1&&(e=!1)}),e},this.remove=function(t){var e=this.filter(function(e,r){return t(e,r)}),n=!0,i=function(t){if(t instanceof Array)t.forEach(function(t){i(t)});else if(t instanceof r)if(t.isRoot)console.log("Root node cannot be deleted."),n=!1;else if("array"===t.parent.type()){var e=t.parent.value,a=e.indexOf(t.value);e.splice(a,1)}else delete t.parent.value[t.key];else console.log("Only JefNode objects must be returned from delete callback."),n=!1};return i(e),n},this.has=function(t){if(!this.value)return!1;if(t instanceof RegExp){if("object"===this.type()){for(var e in this.value)if(t.test(e))return!0;return!1}return!1}return void 0!==this.value[t]?!0:!1},this.getType=function(){return this.type()},this.type=function(){return{}.toString.call(this.value).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},this.hasType=function(){if(1===arguments.length)return this.type()===arguments[0];for(var t=0;t<arguments.length;t++)if(this.type()===arguments[t])return!0;return!1},this.refresh=function(){var e={},n=this._internalPath+".";for(var h in this._nodeHash)0===h.indexOf(n)&&(e[h]=!0);var s=this;i(this.value,function(n,i,h,o,u,f,l,c,v){if(!l){var p=s._internalPath+"."+t(h);e[p]=!1;var d;if(s._nodeHash[p])d=s._nodeHash[p];else{d=new r,d._nodeHash=s._nodeHash,d.root=s._nodeHash[a],d._internalPath=p,d.pathArray=s.pathArray.concat(h),d.path=s.isRoot?t(d.pathArray):s.path+"."+t(d.pathArray),d.key=n,s._nodeHash[p]=d;var y,_=d.pathArray.slice(0,d.pathArray.length-1);y=0===_.length?s._nodeHash[a]:s._nodeHash[a+"."+t(_)],y&&(d.parent=y),d.parent.count++}d.value=i,d.level=s.level+f,d.isRoot=!1,d.isLeaf=c,d.isCircular=v}});for(var n in e)e[n]===!0&&delete this._nodeHash[n]},this._nodeHash=null,this._internalPath=null,this.print=function(t){var e=[],r=this;return this._iterate(function(n){e.push(t?n._internalPath.replace(a,"root")+" - "+JSON.stringify(r._nodeHash[n._internalPath].value):n._internalPath.replace(a,"root"))}),e},this.count=0,h&&(this.root=this,this._nodeHash={},this.pathArray=[],this.path="",this.value=h,this.level=0,this.isRoot=!0,this.isLeaf=n(h),this.isCircular=!1,this._internalPath=a,this._nodeHash[a]=this,this.parent=this,this.refresh())},n=function(t){var e=t instanceof Array,r="object"==typeof t&&!e,n=r&&null!==t||e;return!n},i=function(t,e){var r=[],i=function(t,a,h,s,o,u,f){var l=a instanceof Array,c="object"==typeof a&&!l,v=n(a),p=!1;if(-1!==r.indexOf(a)?p=!0:r.push(a),e(t,a,u,h,s,f,o,v,p),!p){var d,y;if(c)for(d in a)y=u.concat([d]),i(d,a[d],t,a,!1,y,f+1);if(l)for(var _=0;_<a.length;_++)d=""+_,y=u.concat([d]),i(d,a[_],t,a,!1,y,f+1)}};i(void 0,t,void 0,void 0,!0,[],0)},a="$root_4285190851";return{JefNode:r,traverse:i}}(),JefNode=Jef.JefNode,traverse=Jef.traverse;
