var Jef=function(){"use strict";var t=function(t,e){e||(e=".");for(var n="",r=0;r<t.length;r++)0!==r&&(n+=e),n+=t[r];return n},e=function(e,n){this.isRoot=!1,n.path===e.path&&(this.isRoot=!0),this.level=e.pathArray.length-n.pathArray.length,this.pathArray=e.pathArray.slice(n.pathArray.length,e.pathArray.length),this.path=t(this.pathArray)},n=function(h){this.isEmpty=function(){return 0===this.count},this.get=function(t){if(!t)return this;var e;return e=this.isRoot?t:this.path+"."+t,this._nodeHash[a+"."+e]},this._iterate=function(t){var e=this._internalPath+".";t(this);for(var n in this._nodeHash)if(0===n.indexOf(e)){var r=this._nodeHash[n];t(r)}},this.filter=function(t){var n=[],r=this;return this._iterate(function(i){var a=t(i,new e(i,r));void 0!==a&&n.push(a)}),n},this.validate=function(t){var e=!0;return this.filter(function(n,r){var i=t(n,r);i===!1&&(e=!1)}),e},this.remove=function(t){var e=this.filter(function(e,n){return t(e,n)}),r=!0,i=function(t){if(t instanceof Array)t.forEach(function(t){i(t)});else if(t instanceof n)if(t.isRoot)console.log("Root node cannot be deleted."),r=!1;else if("array"===t.parent.type()){var e=t.parent.value,a=e.indexOf(t.value);e.splice(a,1)}else delete t.parent.value[t.key];else console.log("Only JefNode objects must be returned from delete callback."),r=!1};return i(e),r},this.has=function(t){if(!this.value)return!1;if(t instanceof RegExp){if("object"===this.type()){for(var e in this.value)if(t.test(e))return!0;return!1}return!1}return void 0!==this.value[t]?!0:!1},this.getType=function(){return this.type()},this.type=function(){return{}.toString.call(this.value).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},this.hasType=function(){if(1===arguments.length)return this.type()===arguments[0];for(var t=0;t<arguments.length;t++)if(this.type()===arguments[t])return!0;return!1},this.refresh=function(){var e=this,r={};this._iterate(function(t){t._internalPath!==e._internalPath&&(r[t._internalPath]=!0)}),i(this.value,function(i,h,s,o,f,u,l,c,v){if(!l){var p=e._internalPath+"."+t(s);r[p]=!1;var d;if(e._nodeHash[p])d=e._nodeHash[p];else{d=new n,d._nodeHash=e._nodeHash,d._internalPath=p,d.pathArray=e.pathArray.concat(s),d.path=e.isRoot?t(d.pathArray):e.path+"."+t(d.pathArray),d.key=i,e._nodeHash[p]=d;var y,_=d.pathArray.slice(0,d.pathArray.length-1);y=0===_.length?e._nodeHash[a]:e._nodeHash[a+"."+t(_)],y&&(d.parent=y),d.parent.count++}d.value=h,d.level=e.level+u,d.isRoot=!1,d.isLeaf=c,d.isCircular=v}});for(var h in r)r[h]===!0&&delete this._nodeHash[h]},this._nodeHash=null,this._internalPath=null,this.print=function(t){var e=[],n=this;return this._iterate(function(r){e.push(t?r._internalPath.replace(a,"root")+" - "+JSON.stringify(n._nodeHash[r._internalPath].value):r._internalPath.replace(a,"root"))}),e},this.count=0,h&&(this._nodeHash={},this.pathArray=[],this.path="",this.value=h,this.level=0,this.isRoot=!0,this.isLeaf=r(h),this.isCircular=!1,this._internalPath=a,this._nodeHash[a]=this,this.parent=this,this.refresh())},r=function(t){var e=t instanceof Array,n="object"==typeof t&&!e,r=n&&null!==t||e;return!r},i=function(t,e){var n=[],i=function(t,a,h,s,o,f,u){var l=a instanceof Array,c="object"==typeof a&&!l,v=r(a),p=!1;if(-1!==n.indexOf(a)?p=!0:n.push(a),e(t,a,f,h,s,u,o,v,p),!p){var d,y;if(c)for(d in a)y=f.concat([d]),i(d,a[d],t,a,!1,y,u+1);if(l)for(var _=0;_<a.length;_++)d=""+_,y=f.concat([d]),i(d,a[_],t,a,!1,y,u+1)}};i(void 0,t,void 0,void 0,!0,[],0)},a="$root_4285190851";return{JefNode:n,traverse:i}}(),JefNode=Jef.JefNode,traverse=Jef.traverse;
